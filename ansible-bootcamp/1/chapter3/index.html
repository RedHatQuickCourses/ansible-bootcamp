<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Automation Developer Experience :: Ansible Boot Camp Day 1</title>
    <link rel="prev" href="../chapter2/section1.html">
    <link rel="next" href="section1.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Ansible Boot Camp Day 1</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/ansible-bootcamp/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ansible-bootcamp" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Ansible Boot Camp Day 1</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Tested Topologies for AAP 2.6</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section1.html">RPM Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section2.html">Containerized Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/section3.html">Operator Installation</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">Ansible Automation Platform on Azure</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Section 1</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Automation Developer Experience</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Section 1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Section 2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Ansible Boot Camp Day 1</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Ansible Boot Camp Day 1</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Ansible Boot Camp Day 1</a></li>
    <li><a href="index.html">Automation Developer Experience</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Automation Developer Experience</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
We will explore essential software development practices applied to automation development, including git workflows, secret scanning with pre-commit hooks, and comprehensive testing. This lab covers treating automation as code with proper linting, testing, and CI/CD practices, culminating in an overview of the Ansible Development Tools suite.
</blockquote>
</div>
<div class="paragraph">
<p>This lab walks through some of the basic software development practices as they apply to automation development. Finally, it concludes with an overview of the Ansible Development Tools. All automation files should be treated as code. This means scanning for code syntax and quality, checking that sensitive assets have not been exposed, and testing your code as much as possible before committing it. Once committed to git and published, consider it public and without effort will be there forever.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_learning_objectives"><a class="anchor" href="#_learning_objectives"></a>Learning Objectives</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After completing this module, you will be able to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apply software development best practices to automation code</p>
</li>
<li>
<p>Use git effectively for version control in automation projects</p>
</li>
<li>
<p>Implement pre-commit hooks for code quality and security</p>
</li>
<li>
<p>Set up comprehensive testing frameworks for automation</p>
</li>
<li>
<p>Navigate the Ansible Development Tools ecosystem</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_git"><a class="anchor" href="#_1_git"></a>1: Git</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While a local directory can be used to manage resources related to automation development, it is generally considered best practice that version control tools be utilized. These days, when speaking of version control, we are referring to <a href="https://git-scm.com" target="<em>blank">Git</a>. Furthermore, to properly scale automation across an enterprise, <code>git</code> _proficiency</em> is required.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This lab covers the extreme basics of <code>git</code>. For many of you, this may be second nature, so feel free to skip basic concepts you are already familiar with.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_1_1_cli_completion"><a class="anchor" href="#_1_1_cli_completion"></a>1.1: CLI Completion</h3>
<div class="paragraph">
<p>While not required, sourcing these two files will greatly improve your CLI interactions. Note that this can also be added to the <code>devfile</code> for Dev Spaces customization or a local <code>.bashrc</code> file.</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">source /usr/share/bash-completion/completions/git
source /usr/share/git-core/contrib/completion/git-prompt.sh
PS1='[\u \W$(__git_ps1 " (%s)")]\$ '</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice your prompt will now display which branch you are currently operating against. Also, <code>git</code> sub commands now auto-complete with the TAB key. Feel free to customize this prompt as desired.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_2_set_global_settings"><a class="anchor" href="#_1_2_set_global_settings"></a>1.2: Set Global Settings</h3>
<div class="paragraph">
<p>Before working with Git in your Ansible Workspace, you will need to set your global username and email. This metadata is used when committing code so that it can be associated with the user who made the change:</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ git config --global user.name "First Last"
$git config --global user.email "email@example.com"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_1_3_branches"><a class="anchor" href="#_1_3_branches"></a>1.3: Branches</h3>
<div class="paragraph">
<p>link;<a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell">Branches</a> should be used liberally. They can be used to test ideas and have no fear trashing a branch that didn&#8217;t quite work out. It&#8217;s better to leave a branch as is and start a new one based on your current working branch rather than testing a few things and reverting the commits or comment/uncomment things. Using the new <code>git</code> prompt configured previously, your prompt should update when your branch changes similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[user devspaces-example (main)]$ git branch
* main

[user devspaces-example (main)]$ git checkout -b test
Switched to a new branch 'test'

[user devspaces-example (test)]$ git branch
  main
* test</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since a <code>git</code> repository is used to manage an OpenShift Dev Spaces workspace, the current directory that you are operating within is already an initialized as a git repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>main</code> is the name of the branch that is typically used as the default branch. <code>master</code> is also another name that was used in the past. however, most newer repositories make use of <code>main</code> as the default branch. The <code>git config --global init.defaultBranch</code> command can be used to configure your <code>git</code> client with the name of the default branch for new repositories.</p>
</div>
<div class="paragraph">
<p>Switch back to the <code>main</code> branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[user devspaces-example (test)]$ git checkout main
Switched to branch 'main'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, delete the <code>test</code> branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[user devspaces-example (main)]$ git branch -d test
Deleted branch test (was 1234567).</code></pre>
</div>
</div>
<div class="paragraph">
<p>See how easy it was to create and delete branches in <code>git</code>!</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_4pullmerge_requests"><a class="anchor" href="#_1_4pullmerge_requests"></a>1.4:Pull/Merge Requests</h3>
<div class="paragraph">
<p>Pull/Merge (PR/MR) requests are used when contributing code in a shared git server with collaboration capabilities (GitHub, GitLab, Gitea etc) and you want to merge a branch into another branch. Typically, this is a feature branch with your work that you want to merge into the <code>main</code> branch. However, it could be any other branch target. PR/MR&#8217;s are an essential way to review code and allow others to comment and provide feedback or changes. PR/MRs can also be used to kick off pipelines to run further automation activities based on this branch of code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_merge_conflicts"><a class="anchor" href="#_merge_conflicts"></a>Merge conflicts</h3>
<div class="paragraph">
<p>When a change is detected on the same line and git is unable to automatically apply the changes, human intervention is needed. Several strategies and tools are available to assist you with resolving the conflict.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_5_branch_update_strategies"><a class="anchor" href="#_1_5_branch_update_strategies"></a>1.5: Branch update strategies</h3>
<div class="paragraph">
<p>When working in a branch, it is often necessary to ensure your branch has the latest commits that are in <code>main</code>. If it has been a while since you created or updated your branch, it could be several commits behind.</p>
</div>
<div class="paragraph">
<p><em>Merge</em> will take two divergent branches and preserve their history, adding a commit to tie them together</p>
</div>
<div class="paragraph">
<p><em>Rebase</em> will rewind and play commits back in order resulting in a cleaner, more linear history, but can make merge conflicts more difficult to manage.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_6_cleaning_up_git_history"><a class="anchor" href="#_1_6_cleaning_up_git_history"></a>1.6: Cleaning up git history</h3>
<div class="paragraph">
<p>While you generally should not be editing git history, there are times where this is necessary. Perhaps commits were made with a default or incorrect <code>user.name</code> or <code>user.email</code> and needed to be corrected. Maybe you want to combine several commits that you made locally before publishing (also known as <em>squashing</em>). Or, perhaps secrets were leaked and though cleaned up in HEAD (the current active commit), they are still in git history. In these cases, it is possible to edit specific commits or a series of commits.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_secrets_scanning"><a class="anchor" href="#_2_secrets_scanning"></a>2: Secrets Scanning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is absolutely vital that you never EVER commit any secrets to git. Even if you revert the commit or delete the file, it is still in history. Even if it is "just a lab server" or "only internal", a secret will trigger many security scans requiring additional work to explain if it is valid and needs rotating or not. Just don&#8217;t do it. This lab will walk through using a tool like <a href="https://gitleaks.io" target="_blank" rel="noopener">Gitleaks</a> to help keep your secrets out of git.</p>
</div>
<div class="paragraph">
<p>First, create a fake API-like key. The default regex and patterns will determine a UUID-like value to be similar to an API key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd /projects/devspaces-example/
$ echo key=$(uuidgen) &gt; secret
$ cat secret
key=3863b2c6-cc7b-4832-92b6-5b82d6b1a987</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gitleaks is available as a container image, so no installation is necessary.</p>
</div>
<div class="paragraph">
<p>Pull the image into your Dev Spaces workspace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman pull docker.io/zricethezav/gitleaks:latest
Trying to pull docker.io/zricethezav/gitleaks:latest...
Getting image source signatures
Copying blob 91da3791a8e8 done   |
Copying blob daed8b4062ea done   |
Copying blob e590f02e913a done   |
Copying blob 1747dece9491 done   |
Copying config 49c41c2292 done   |
Writing manifest to image destination
49c41c2292e05b683dd2dbbe7f7677ca397722f1f0364adf615a3a6913f71ade</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>gitleaks</code> to scan the directory containing the generated fake secret by mounting the current working directory into the gitleaks container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ podman run -v /projects/devspaces-example/:/scan:Z zricethezav/gitleaks:latest dir -v /scan/

    ○
    │╲
    │ ○
    ○ ░
    ░    gitleaks

Finding:     key=3863b2c6-cc7b-4832-92b6-5b82d6b1a987
Secret:      3863b2c6-cc7b-4832-92b6-5b82d6b1a987
RuleID:      generic-api-key
Entropy:     3.583275
File:        /scan/secret
Line:        1
Fingerprint: /scan/secret:generic-api-key:1

1:43AM INF scanned ~15523 bytes (15.52 KB) in 10.9ms
1:43AM WRN leaks found: 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default rules should detect the UUID as an API key.</p>
</div>
<div class="paragraph">
<p>While this was only a brief introduction, we hope that you can see just how vital a tool such as <em>gitleaks</em> can be to keep you and the content of your git repository free of sensitive assets.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_pre_commit"><a class="anchor" href="#_3_pre_commit"></a>3: Pre-Commit</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://pre-commit.com/" target="_blank" rel="noopener">pre-commit</a> is a tool that essentially hooks into the <code>git</code> lifecycle and runs additional tooling before the commit writes changes to git history. This is a perfect way to automatically invoke actions, like <code>ansible-lint</code> and <code>gitleaks</code>, before having to go back and squash or clean up git history.</p>
</div>
<div class="paragraph">
<p>Install pre-commit using <code>pip</code>:</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ pip install --user pre-commit</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Collecting pre-commit
  Downloading pre_commit-4.3.0-py2.py3-none-any.whl (220 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 221.0/221.0 kB 26.4 MB/s eta 0:00:00
Collecting cfgv&gt;=2.0.0
  Downloading cfgv-3.4.0-py2.py3-none-any.whl (7.2 kB)
Collecting identify&gt;=1.0.0
  Downloading identify-2.6.15-py2.py3-none-any.whl (99 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 99.2/99.2 kB 63.9 MB/s eta 0:00:00
Collecting nodeenv&gt;=0.11.1
  Downloading nodeenv-1.9.1-py2.py3-none-any.whl (22 kB)
Requirement already satisfied: pyyaml&gt;=5.1 in /usr/local/lib64/python3.11/site-packages (from pre-commit) (6.0.3)
Requirement already satisfied: virtualenv&gt;=20.10.0 in /usr/local/lib/python3.11/site-packages (from pre-commit) (20.25.1)
Requirement already satisfied: distlib&lt;1,&gt;=0.3.7 in /usr/local/lib/python3.11/site-packages (from virtualenv&gt;=20.10.0-&gt;pre-commit) (0.3.8)
Requirement already satisfied: filelock&lt;4,&gt;=3.12.2 in /usr/local/lib/python3.11/site-packages (from virtualenv&gt;=20.10.0-&gt;pre-commit) (3.13.1)
Requirement already satisfied: platformdirs&lt;5,&gt;=3.9.1 in /usr/local/lib/python3.11/site-packages (from virtualenv&gt;=20.10.0-&gt;pre-commit) (4.2.0)
Installing collected packages: nodeenv, identify, cfgv, pre-commit
  WARNING: The script nodeenv is installed in '/home/user/.local/bin' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  WARNING: The script identify-cli is installed in '/home/user/.local/bin' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  WARNING: The script pre-commit is installed in '/home/user/.local/bin' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
Successfully installed cfgv-3.4.0 identify-2.6.15 nodeenv-1.9.1 pre-commit-4.3.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice the <strong>WARNING:</strong> this tells you the path the binary was installed to.</p>
</div>
<div class="paragraph">
<p>Create a <em>pre-commit</em> configuration file by creating a new file called <code>.pre-commit-config.yaml</code> with the following content:</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">repos:
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.28.0
    hooks:
      - id: gitleaks
        name: gitleaks
        entry: podman run -v /projects/devspaces-example:/scan:Z zricethezav/gitleaks:latest dir -v /scan/
        language: system
        stages: [pre-commit]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install the pre-commit hook:</p>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ /home/user/.local/bin/pre-commit install

 pre-commit installed at .git/hooks/pre-commit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attempt a <code>git commit</code> which should fail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ git add secret
$ git commit

gitleaks.................................................................Failed
- hook id: gitleaks
- exit code: 1

○
    │╲
    │ ○
    ○ ░
    ░    gitleaks

Finding:     key=3863b2c6-cc7b-4832-92b6-5b82d6b1a987
Secret:      3863b2c6-cc7b-4832-92b6-5b82d6b1a987
RuleID:      generic-api-key
Entropy:     3.583275
File:        /gitleaks/secret
Line:        1
Fingerprint: /gitleaks/secret:generic-api-key:1

1:22AM INF scanned ~15523 bytes (15.52 KB) in 7.62ms
1:22AM WRN leaks found: 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>git status</code> and confirm the file is still staged for commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">bash-5.1$ git status
On branch main
Your branch is up to date with 'origin/main'.

Changes to be committed:
  (use "git restore --staged &lt;file&gt;..." to unstage)
        new file:   secret

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)
        .pre-commit-config.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this way, a developer never needs to remember to run a tool before a commit. <em>pre-commit</em> will do the work for you, keeping mistakes out of git history. For a more comprehensive exploration of pre-commit and the pre-commit-config, see <a href="https://github.com/redhat-cop/infra.aap_configuration/blob/devel/.pre-commit-config.yaml" class="bare">https://github.com/redhat-cop/infra.aap_configuration/blob/devel/.pre-commit-config.yaml</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_ansible_development_tools_adt"><a class="anchor" href="#_4_ansible_development_tools_adt"></a>4: Ansible Development Tools (ADT)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.redhat.com/en/technologies/management/ansible/development-tools" target="_blank" rel="noopener">Ansible Development Tools</a> is a curated suite of tools to help Ansible automation developers be more productive. These tools cover a wide range of activities from scaffolding new projects, building execution environments, linting code, testing code, and signing content.</p>
</div>
<div class="paragraph">
<p>In your terminal, view the installed Ansible Development Tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ adt --version
ansible-builder                          3.1.0
ansible-core                             2.19.3
ansible-creator                          25.9.0
ansible-dev-environment                  25.8.0
ansible-dev-tools                        25.8.3
ansible-lint                             25.9.2
ansible-navigator                        25.9.0
ansible-sign                             0.1.2
molecule                                 25.9.0
pytest-ansible                           25.8.0
tox-ansible                              25.8.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The curated list of tools installed as part of the Ansible automation developer tools package includes:</p>
</div>
<div class="paragraph">
<p><code>ansible-builder</code>: a utility for building Ansible execution environments.</p>
</div>
<div class="paragraph">
<p><code>ansible-core</code>: Ansible is a radically simple IT automation platform that makes your applications and systems easier to deploy and maintain. Automate everything from code deployment to network configuration to cloud management, in a language that approaches plain English, using SSH, with no agents to install on remote systems.</p>
</div>
<div class="paragraph">
<p><code>ansible-creator</code>: a utility for scaffolding Ansible projects and content with leading practices.</p>
</div>
<div class="paragraph">
<p><code>ansible-lint</code>: a utility to identify and correct stylistic errors and anti-patterns in Ansible playbooks and roles.</p>
</div>
<div class="paragraph">
<p><code>ansible-navigator</code>: a text-based user interface (TUI) for developing and troubleshooting Ansible content with execution environments.</p>
</div>
<div class="paragraph">
<p><code>ansible-sign</code>: a utility for signing and verifying Ansible content.</p>
</div>
<div class="paragraph">
<p><code>molecule</code>: Molecule aids in the development and testing of Ansible content: collections, playbooks and roles</p>
</div>
<div class="paragraph">
<p><code>pytest-ansible</code>: a pytest testing framework extension that provides additional functionality for testing Ansible module and plugin Python code.</p>
</div>
<div class="paragraph">
<p><code>tox-ansible</code>: an extension to the tox testing utility that provides additional functionality to check Ansible module and plugin Python code under different Python interpreters and Ansible core versions.</p>
</div>
<div class="paragraph">
<p><code>ansible-dev-environment</code>: a utility for building and managing a virtual environment for Ansible content development.</p>
</div>
<div class="sect2">
<h3 id="_4_1_visual_studio_code_vs_code_extension"><a class="anchor" href="#_4_1_visual_studio_code_vs_code_extension"></a>4.1: Visual Studio Code (VS Code) Extension</h3>
<div class="paragraph">
<p>Ansible includes a Visual Studio Code (VS Code) extension to enhance the development experience. You can learn more about the features that are available in the extension at <a href="https://ansible.readthedocs.io/projects/vscode-ansible/" class="bare">https://ansible.readthedocs.io/projects/vscode-ansible/</a></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the Ansible extension on the left hand side of the Dev Spaces window</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-extension1.png" alt="ansible extension1">
</div>
</div>
</li>
<li>
<p>For this lab, we will not be using Lightspeed, so feel free to close these panes</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-extension2.png" alt="ansible extension2">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_4_2_creating_a_playbook_project"><a class="anchor" href="#_4_2_creating_a_playbook_project"></a>4.2: Creating a Playbook Project</h3>
<div class="paragraph">
<p>Now that we have covered the basics of tools available as an automation developer, let&#8217;s walk through bringing it all together. While not a command-line tool, the VS Code extension ties together functionality of Dev Spaces and Ansible Development Tools into the development Workspace you are currently using. This portion of the lab will walk through several aspects of automation development activities in this Workspace.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Within the <em>Initialize</em> section of the Ansible Development Tools, click on <code>Playbook project</code> to open a dialog to create a new project.</p>
<div class="paragraph">
<p>Specify the following values within the playbook project creation dialog:</p>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator1.png" alt="ansible creator1">
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Destination directory: <code>/projects/myproject</code></p>
</li>
<li>
<p>Namespace: <code>mynamespace</code></p>
</li>
<li>
<p>Collection: <code>mycollection</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Create</strong></p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator2.png" alt="ansible creator2">
</div>
</div>
</li>
<li>
<p>The logs will display in the box below that</p>
</li>
<li>
<p>Click <code>Open Project</code> to open a new VS Code window with this new project</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator3.png" alt="ansible creator3">
</div>
</div>
</li>
<li>
<p>Once the Dev Spaces Workspace loads with the new folder structure, select the <strong>Yes, I trust the Authors</strong> button again and begin to explore the directories and files created by <code>ansible-creator</code>, which was generated using industry standard good practices:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator4.png" alt="ansible creator4">
</div>
</div>
</li>
<li>
<p>The <code>inventory</code> director contains a ready to use directory structure:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator6.png" alt="ansible creator6">
</div>
</div>
</li>
<li>
<p>The <code>collections</code> directory contains the tree structure representing how a collection is organized, a collection called <code>mycollection</code> and a simple role called <code>run</code> with a few tasks.</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator5.png" alt="ansible creator5">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_4_3_running_playbooks_in_vs_code"><a class="anchor" href="#_4_3_running_playbooks_in_vs_code"></a>4.3: Running playbooks in VS Code</h3>
<div class="paragraph">
<p>While you may be familiar with <code>ansible-playbook</code> or even <code>ansible-navigator</code> on the CLI, VS Code provides a way to execute them via ClickOps if so desired.</p>
</div>
<div class="sect3">
<h4 id="_4_3_1_running_playbooks_via_ansible_playbook_in_vs_code"><a class="anchor" href="#_4_3_1_running_playbooks_via_ansible_playbook_in_vs_code"></a>4.3.1: Running playbooks via ansible-playbook in VS Code</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right-click on the file at the base of the directory called <code>site.yml</code> and choose <code>Run Ansible Playbook Via &#8230;&#8203;</code></p>
</li>
<li>
<p>Choose <code>Run playbook via  'ansible-playbook'</code>.</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-playbook1.png" alt="ansible playbook1">
</div>
</div>
</li>
<li>
<p>A terminal opens up with the results of the <code>ansible-playbook</code> execution:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-playbook2.png" alt="ansible playbook2">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_4_3_2running_playbooks_via_ansible_navigator_in_vs_code"><a class="anchor" href="#_4_3_2running_playbooks_via_ansible_navigator_in_vs_code"></a>4.3.2:Running playbooks via ansible-navigator in VS Code</h4>
<div class="paragraph">
<p>Alternatively, <code>ansible-navigator</code> can be used to execute the <code>site.yml</code> playbook.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right-click on the file at the base of the directory <code>site.yml</code> and choose <code>Run Ansible Playbook Via &#8230;&#8203;</code></p>
</li>
<li>
<p>Choose <code>Run playbook via  'ansible-navigator run'</code>.</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-navigator1.png" alt="ansible navigator1">
</div>
</div>
</li>
<li>
<p>This will open a terminal and run <code>ansible-navigator run site.yml --ee false</code>. When the run is finished you will see a <code>Complete</code> message in <code>ansible-navigator</code>:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-navigator2.png" alt="ansible navigator2">
</div>
</div>
</li>
<li>
<p>Click inside the terminal and enter <code>0</code> to inspect the execution of the play. You can inspect the output of any of the tasks included within this play. e.g. <code>3</code>:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-navigator3.png" alt="ansible navigator3">
</div>
</div>
</li>
<li>
<p>Once reviewed, hit <code>ESC</code> several times until you exit <code>ansible-navigator</code> and return back to the terminal.</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-navigator4.png" alt="ansible navigator4">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_4_3_3_using_ansible_lint_in_vs_code"><a class="anchor" href="#_4_3_3_using_ansible_lint_in_vs_code"></a>4.3.3: Using ansible-lint in VS Code</h4>
<div class="paragraph">
<p>The VS Code Ansible extension proactively runs <code>ansible-lint</code> on any playbook you are editing. Experiment with this tool to understand how the feature works.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Append the existing <code>site.yml</code> playbook with the following poorly written task</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  tasks:
    - debug:
        msg: "Hello"</code></pre>
</div>
</div>
</li>
<li>
<p>As soon as you finish editing, the autosave feature will kick in and run <code>ansible-lint</code>. Notice the message and the bottom of the screen:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint1.png" alt="ansible lint1">
</div>
</div>
</li>
<li>
<p>The extension should have added red squiggly lines underneath <code>debug</code>. Hover over the red squiggly lines to see the violations:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint2.png" alt="ansible lint2">
</div>
</div>
</li>
<li>
<p>You can fix these manually. However, why not let automation and  <code>ansible-lint</code> do the work for you? Open the extension settings:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint3.png" alt="ansible lint3">
</div>
</div>
</li>
<li>
<p>Open <strong>Settings</strong> for the Ansible extension:</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint4.png" alt="ansible lint4">
</div>
</div>
</li>
<li>
<p>Under the Ansible extension settings, click on the <strong>Validation</strong> subsection and enter <code>--fix</code> as an extra argument</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint5.png" alt="ansible lint5">
</div>
</div>
</li>
<li>
<p>Close the settings page and save the file with either the main menu <code>File</code> &#8594; <code>Save</code> or <code>CTRL/CMD + s</code></p>
</li>
<li>
<p><code>ansible-lint --fix</code> will automatically correct errors</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-lint6.png" alt="ansible lint6">
</div>
</div>
</li>
<li>
<p>Notice it did not fix every violation, such as adding a <code>name:</code> key for the <em>debug</em> task. Feel free to fix this manually if you choose. Not every rule is enforced automatically. See <code>man ansible-lint</code> for more information.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_4creating_a_collection_project"><a class="anchor" href="#_4_4creating_a_collection_project"></a>4.4:Creating a Collection project</h3>
<div class="paragraph">
<p>You can close the previous project window and return to the original Workspace. Once in the original Workspace, create a new Ansible Collection project using the Ansible extension.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the Ansible extension icon on the left side of the VS Code window</p>
</li>
<li>
<p>Under the <em>Initialize</em> section of the Ansible Development Tools panel, click on the <code>Collection project</code> link.</p>
</li>
<li>
<p>Enter the following details:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Namespace: <code>mynamespace</code></p>
</li>
<li>
<p>Collection: <code>mycollection2</code></p>
</li>
<li>
<p>Init path: this value should be autodetected for you as <code>/projects/myproject/.ansible/collections/ansible_collections</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <code>Create</code></p>
</li>
<li>
<p>When complete, click <strong>Open Collection</strong> to open the new collection project in a new VS Code window.</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator7.png" alt="ansible creator7">
</div>
</div>
</li>
<li>
<p>Explore the scaffolded files to see their content</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>.gitignore</code>: pre-loaded with settings to ignore files in our git repository and make and avoid including unnecessary or undesired files.</p>
</li>
<li>
<p><code>test-requirements.txt</code>: Already includes the Ansible Python dependencies required for running tests.</p>
</li>
<li>
<p><code>.github/workflows</code>: Sample workflow for your collection to run CI capabilities on <a href="https://github.com/features/actions" target="_blank" rel="noopener">GitHub Actions</a></p>
</li>
<li>
<p><code>.pre-commit-config</code>: Includes many useful pre-commit utilities</p>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator8.png" alt="ansible creator8">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Review the included sample role <code>run</code> and its tasks. Feel free to create a playbook that invokes the collection using the tools that you learned in this lab.</p>
</li>
</ol>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="03-developer-tools/ansible-creator9.png" alt="ansible creator9">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lab, you have successfully learned essential software development practices and tools that can be applied to automation development:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Git version control fundamentals, including branching strategies and merge conflicts</p>
</li>
<li>
<p>Secret scanning using <code>gitleaks</code> and <code>pre-commit</code> hooks for automated code quality checks</p>
</li>
<li>
<p>Ansible Development Tools suite including <code>ansible-lint</code>, <code>ansible-navigator</code>, and VS Code extensions</p>
</li>
<li>
<p>Creating and managing Ansible projects and collections through the VS Code interface</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This foundation prepares you to develop automation content that follows industry best practices for code quality, security, and maintainability.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../chapter2/section1.html">Section 1</a></span>
  <span class="next"><a href="section1.html">Section 1</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
